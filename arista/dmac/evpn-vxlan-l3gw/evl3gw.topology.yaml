name: evl3gw-dmac
prefix: ""
topology:
    kinds:
        arista_ceos:
            # startup-config: ../startup_config/ceos.cfg.tpl
            image: ceos:4.34.3.1M
            env:
                CLAB_MGMT_VRF: MGMT
            exec:
                - sleep 10
                - FastCli -p 15 -c 'security pki key generate rsa 2048 eAPI.key'
                # yamllint disable-line rule:line-length
                - FastCli -p 15 -c 'security pki certificate generate self-signed eAPI.crt key eAPI.key generate rsa 2048
                  validity 30000 parameters common-name eAPI'
        linux:
            image: alpine-host
    nodes:
        s1:
            kind: arista_ceos
            mgmt-ipv4: 172.100.100.121
            aliases:
                - s1
        s2:
            kind: arista_ceos
            mgmt-ipv4: 172.100.100.122
            aliases:
                - s2
        l1:
            kind: arista_ceos
            mgmt-ipv4: 172.100.100.61
            aliases:
                - l1
        l2:
            kind: arista_ceos
            mgmt-ipv4: 172.100.100.62
            aliases:
                - l2
        l3:
            kind: arista_ceos
            mgmt-ipv4: 172.100.100.63
            aliases:
                - l3
        l4:
            kind: arista_ceos
            mgmt-ipv4: 172.100.100.64
            aliases:
                - l4
        l5:
            kind: arista_ceos
            mgmt-ipv4: 172.100.100.65
            aliases:
                - l5
        h1:
            kind: linux
            mgmt-ipv4: 172.100.100.21
            aliases:
                - h1
            env:
                TMODE: lacp
        h2:
            kind: linux
            mgmt-ipv4: 172.100.100.22
            aliases:
                - h2
            env:
                TMODE: lacp
        h3:
            kind: linux
            mgmt-ipv4: 172.100.100.23
            aliases:
                - h3
            env:
                TMODE: lacp
        h4:
            kind: linux
            mgmt-ipv4: 172.100.100.24
            aliases:
                - h4
            env:
                TMODE: lacp
        h5:
            kind: linux
            mgmt-ipv4: 172.100.100.25
            aliases:
                - h5
            env:
                TMODE: lacp
    links:
        # Leaves to Spine 1
        - endpoints: ["l1:eth1", "s1:eth1"]
        - endpoints: ["l2:eth1", "s1:eth2"]
        - endpoints: ["l3:eth1", "s1:eth3"]
        - endpoints: ["l4:eth1", "s1:eth4"]
        - endpoints: ["l5:eth1", "s1:eth5"]
        # Leaves to Spine 2
        - endpoints: ["l1:eth2", "s2:eth1"]
        - endpoints: ["l2:eth2", "s2:eth2"]
        - endpoints: ["l3:eth2", "s2:eth3"]
        - endpoints: ["l4:eth2", "s2:eth4"]
        - endpoints: ["l5:eth2", "s2:eth5"]
        # Hosts to leaves
        ## Host 1
        - endpoints: ["h1:eth1", "l1:eth3"]
        - endpoints: ["h1:eth2", "l2:eth3"]
        - endpoints: ["h2:eth1", "l1:eth4"]
        - endpoints: ["h2:eth2", "l2:eth4"]
        - endpoints: ["h3:eth1", "l3:eth3"]
        - endpoints: ["h3:eth2", "l4:eth3"]
        - endpoints: ["h4:eth1", "l3:eth4"]
        - endpoints: ["h4:eth2", "l4:eth4"]
        - endpoints: ["h5:eth1", "l5:eth3"]
mgmt:
    network: ceos_clab
    ipv4-subnet: 172.100.100.0/24
    ipv6-subnet: 2001:172:100:100::/80
